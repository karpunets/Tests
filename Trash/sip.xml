<?xml version="1.0" encoding="ISO-8859-1" ?>
   <!DOCTYPE scenario SYSTEM "sipp.dtd">
   
   <!-- This program is free software; you can redistribute it and/or      -->
   <!-- modify it under the terms of the GNU General Public License as     -->
   <!-- published by the Free Software Foundation; either version 2 of the -->
   <!-- License, or (at your option) any later version.                    -->
   <!--                                                                    -->
   <!-- This program is distributed in the hope that it will be useful,    -->
  <!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->
  <!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->
  <!-- GNU General Public License for more details.                       -->
  <!--                                                                    -->
  <!-- You should have received a copy of the GNU General Public License  -->
  <!-- along with this program; if not, write to the                      -->
  <!-- Free Software Foundation, Inc.,                                    -->
  <!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->
  <!--                                                                    -->
  <!--                 Sipp 'uac' scenario with pcap (rtp) play           -->
  <!--                                                                    -->
  
  <scenario name="UAC with media">
    <!-- In client mode (sipp placing calls), the Call-ID MUST be         -->
    <!-- generated by sipp. To do so, use [call_id] keyword.                -->
    <send>
        <![CDATA[
          INVITE sip:[service]@[remote_ip]:[remote_port] SIP/2.0
          Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]
          From: <sip:3399222@[local_ip];[field1];x-refci=[field0];x-nearendclusterid=StandAloneCluster;x-nearenddevice=54ee754a879e;x-nearendaddr=3399222;x-farendrefci=25410701;x-farendclusterid=StandAloneCluster;x-farenddevice=[field2];x-farendaddr=1056>;tag=[call_number]~f643f5b4-6431-42a7-b82c-b7175b6c3219-28913122
          To: <sip:[service]@[remote_ip]>
          Call-ID: [call_id]
          Date: Mon, 18 Dec 2017 21 GMT
          Supported: timer,resource-priority,replaces,X-cisco-srtp-fallback,Geolocation
          Min-SE: 1800
          User-Agent: Cisco-CUCM10.5
          Allow: INVITE,OPTIONS,INFO,BYE,CANCEL,ACK,PRACK,UPDATE,REFER,SUBSCRIBE,NOTIFY
          CSeq: 101 INVITE
          Expires: 180
          Allow-Events: presence,kpml
          Call-Info:  <sip:[local_ip]:[local_port]>;method="NOTIFY;Event=telephone-event;Duration=500"
          Cisco-Guid: 4062038400-0000065536-0000000075-0201463468
          Session-Expires: 1800
          P-Asserted-Identity: <sip:3399222@[local_ip]>
          Remote-Party-ID: <sip:3399222@[local_ip]>;party=calling;screen=yes;privacy=off
          Contact: <sip:3399222@[local_ip]:[local_port];transport=[transport]>;isFocus
          Max-Forwards: 70
          Content-Length: 0
          ]]>
    </send>


    <recv response="180" optional="true">
    </recv>


    <!-- By adding rrs="true" (Record Route Sets), the route sets         -->
    <!-- are saved and used for following messages sent. Useful to test   -->
    <!-- against stateful SIP proxies/B2BUAs.                             -->
    <recv response="200" crlf="true" rrs="true">
    </recv>
  <!---->
    <!-- Packet lost can be simulated in any send/recv message by         -->
    <!-- by adding the 'lost = "10"'. Value can be [1-100] percent.       -->
    <send>
      <![CDATA[ACK sip:[remote_ip]:[remote_port];transport=[transport] SIP/2.0
        Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]
        From: <sip:3399222@[local_ip];[field1];x-refci=[field0];x-nearendclusterid=StandAloneCluster;x-nearenddevice=54ee754a879e;x-nearendaddr=3399222;x-farendrefci=25410701;x-farendclusterid=StandAloneCluster;x-farenddevice=[field2];x-farendaddr=1056>;tag=[call_number]~f643f5b4-6431-42a7-b82c-b7175b6c3219-28913122
        To: <sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]
        Call-ID: [call_id]
        User-Agent: Cisco-CUCM10.5
        CSeq: 101 ACK
        Allow-Events: presence, kpml
        Contact: sip:3399222@[local_ip]:[local_port]
        Max-Forwards: 70
        Subject: Performance Test
        Content-Type: application/sdp
        Content-Length: [len]

        v=0
        o=CiscoSystemsCCM-SIP 63811 1 IN IP[local_ip_type] [local_ip]
        s=SIP Call
        c=IN IP[local_ip_type] [local_ip]
        b=TIAS:64000
        b=CT:64
        b=AS:64
        t=0 0
        m=audio [auto_media_port] RTP/AVP 0 101
        a=ptime:20
        a=rtpmap:0 PCMU/8000
        a=sendonly
        a=rtpmap:101 telephone-event/8000
        a=fmtp:101 0-15
      ]]>
    </send>
  
    <!-- Play a pre-recorded PCAP file (RTP stream)                       -->
    <nop>
      <action>
        <exec play_pcap_audio="pcap/g711a.pcap"/>
      </action>
    </nop>
  
    <!-- Pause 8 seconds, which is approximately the duration of the      -->
    <!-- PCAP file                                                        -->
    <pause milliseconds="8000"/>


 
   <!-- The 'crlf' option inserts a blank line in the statistics report. -->
  <send>
      <![CDATA[
        BYE sip:[remote_ip]:[remote_port];transport=[transport] SIP/2.0
        Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]
        From: <sip:3399222@[local_ip];[field1];x-refci=[field0];x-nearendclusterid=StandAloneCluster;x-nearenddevice=54ee754a879e;x-nearendaddr=3399222;x-farendrefci=25410701;x-farendclusterid=StandAloneCluster;x-farenddevice=[field2];x-farendaddr=1056>;tag=[call_number]~f643f5b4-6431-42a7-b82c-b7175b6c3219-28913122
        To: <sip:[service]@[remote_ip]>[peer_tag_param]
        Call-ID: [call_id]
        User-Agent: Cisco-CUCM10.5
        CSeq: 102 BYE
        Max-Forwards: 70
        P-Asserted-Identity: <sip:3399222@[local_ip]>
        Content-Length: 0
      ]]>
    </send>
 
   <recv response="200" crlf="true">
   </recv>
 
   <!-- definition of the response time repartition table (unit is ms)   -->
   <ResponseTimeRepartition value="10, 20, 30, 40, 50, 100, 150, 200"/>
 
   <!-- definition of the call length repartition table (unit is ms)     -->
   <CallLengthRepartition value="10, 50, 100, 500, 1000, 5000, 10000"/>
 
 </scenario>
 